{
  "title": "Features & API Reference",
  "description": "Complete reference of all available features and code examples from v1.0.0 to latest",
  "sections": [
    {
      "id": "intro",
      "title": "üìñ Introduction",
      "content": [
        {
          "type": "paragraph",
          "text": "MIS Barangay provides a comprehensive set of features for barangay administration. This guide covers all features that have been available since the initial release and continue to be supported in the latest version."
        },
        {
          "type": "paragraph",
          "text": "Below you'll find detailed documentation for each feature with practical code examples."
        }
      ]
    },
    {
      "id": "resident-mgmt",
      "title": "üë• Resident Management",
      "content": [
        {
          "type": "paragraph",
          "text": "Complete system for managing resident information including personal details, household links, and status tracking."
        },
        {
          "type": "card",
          "title": "Key Features",
          "content": "‚Ä¢ Add new residents with comprehensive personal information\n‚Ä¢ Link residents to households\n‚Ä¢ Track resident status (active, inactive)\n‚Ä¢ Search and filter residents by various criteria\n‚Ä¢ View detailed resident profiles\n‚Ä¢ Update resident information in real-time\n‚Ä¢ Export resident data"
        }
      ],
      "subsections": [
        {
          "title": "Database Schema",
          "content": [
            {
              "type": "code",
              "code": "CREATE TABLE residents (\n    id INT(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n    household_id INT(11) UNSIGNED NULL,\n    first_name VARCHAR(100) NOT NULL,\n    middle_name VARCHAR(100) NULL,\n    last_name VARCHAR(100) NOT NULL,\n    suffix VARCHAR(20) NULL,\n    birthdate DATE NOT NULL,\n    birthplace VARCHAR(150) NULL,\n    gender ENUM('Male', 'Female', 'Other'),\n    civil_status VARCHAR(50),\n    religion VARCHAR(100),\n    occupation VARCHAR(150),\n    citizenship VARCHAR(100) DEFAULT 'Filipino',\n    contact_no VARCHAR(15),\n    address VARCHAR(255),\n    voter_status ENUM('Yes', 'No') DEFAULT 'No',\n    disability_status ENUM('Yes', 'No') DEFAULT 'No',\n    remarks TEXT,\n    status ENUM('Active', 'Inactive') DEFAULT 'Active',\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n    FOREIGN KEY (household_id) REFERENCES households(id) ON DELETE SET NULL\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;"
            }
          ]
        },
        {
          "title": "API Endpoints (v1.4.0+)",
          "content": [
            {
              "type": "table",
              "headers": ["Endpoint", "Method", "Description"],
              "rows": [
                ["/api/v1/residents", "GET", "List all residents (returns all data for DataTables)"],
                ["/api/v1/residents?id=X", "GET", "Get resident by ID"],
                ["/api/v1/residents", "POST", "Create new resident (action: 'create')"],
                ["/api/v1/residents", "POST", "Update resident (action: 'update')"],
                ["/api/v1/residents", "POST", "Delete resident (action: 'delete')"],
                ["/api/v1/residents?search=term", "GET", "Search residents by name"],
                ["/api/v1/residents?household_id=X", "GET", "Filter residents by household"]
              ]
            },
            {
              "type": "paragraph",
              "text": "**Legacy Endpoints (Deprecated):** The old endpoints (/resident/get_resident, /resident/save, /resident/update_resident) still work but are deprecated. Use the new API endpoints for new development."
            }
          ]
        },
        {
          "title": "Usage Example (v1.4.0+)",
          "content": [
            {
              "type": "code",
              "code": "// Fetch resident details via API\n$.ajax({\n    url: '/api/v1/residents?id=123',\n    method: 'GET',\n    success: function(response) {\n        if(response.status === 'success') {\n            const data = response.data;\n            $('#firstName').val(data.first_name);\n            $('#lastName').val(data.last_name);\n            $('#birthdate').val(data.birthdate);\n        }\n    }\n});\n\n// Create new resident via API\n$.ajax({\n    url: '/api/v1/residents',\n    method: 'POST',\n    contentType: 'application/json',\n    data: JSON.stringify({\n        action: 'create',\n        first_name: 'Juan',\n        last_name: 'Dela Cruz',\n        birthdate: '1990-05-15',\n        gender: 'Male',\n        address: '123 Main St'\n    }),\n    success: function(response) {\n        if(response.status === 'success') {\n            alert('Resident created successfully!');\n        }\n    }\n});\n\n// Update resident via API\n$.ajax({\n    url: '/api/v1/residents',\n    method: 'POST',\n    contentType: 'application/json',\n    data: JSON.stringify({\n        action: 'update',\n        id: 123,\n        first_name: 'Juan',\n        last_name: 'Dela Cruz',\n        birthdate: '1990-05-15'\n    }),\n    success: function(response) {\n        if(response.status === 'success') {\n            alert('Resident updated successfully!');\n        }\n    }\n});"
            }
          ]
        }
      ]
    },
    {
      "id": "household-mgmt",
      "title": "üè† Household Management",
      "content": [
        {
          "type": "paragraph",
          "text": "Group residents into households and manage family structures with ease."
        },
        {
          "type": "card",
          "title": "Key Features",
          "content": "‚Ä¢ Create and manage household groups\n‚Ä¢ Link multiple residents to a household\n‚Ä¢ Track household composition\n‚Ä¢ View household statistics\n‚Ä¢ Household head designation\n‚Ä¢ Status tracking (active/inactive)"
        }
      ],
      "subsections": [
        {
          "title": "Database Schema",
          "content": [
            {
              "type": "code",
              "code": "CREATE TABLE households (\n    id INT(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n    household_head VARCHAR(255) NOT NULL,\n    address VARCHAR(255) NOT NULL,\n    zone VARCHAR(50),\n    purk VARCHAR(50),\n    status ENUM('Active', 'Inactive') DEFAULT 'Active',\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;"
            }
          ]
        },
        {
          "title": "API Endpoints (v1.4.0+)",
          "content": [
            {
              "type": "table",
              "headers": ["Endpoint", "Method", "Description"],
              "rows": [
                ["/api/v1/households", "GET", "List all households with member count"],
                ["/api/v1/households?id=X", "GET", "Get household by ID"],
                ["/api/v1/households?action=members&household_id=X", "GET", "Get household members"],
                ["/api/v1/households", "POST", "Create household (action: 'create')"],
                ["/api/v1/households", "POST", "Update household (action: 'update')"],
                ["/api/v1/households", "POST", "Delete household (action: 'delete')"]
              ]
            }
          ]
        },
        {
          "title": "Usage Example (v1.4.0+)",
          "content": [
            {
              "type": "code",
              "code": "// Create household via API\n$.ajax({\n    url: '/api/v1/households',\n    method: 'POST',\n    contentType: 'application/json',\n    data: JSON.stringify({\n        action: 'create',\n        household_no: 'HH-001',\n        head_name: 'Juan Dela Cruz',\n        address: '123 Main St, Barangay San Juan'\n    }),\n    success: function(response) {\n        if(response.status === 'success') {\n            console.log('Household created:', response.data);\n        }\n    }\n});\n\n// Get household members\n$.ajax({\n    url: '/api/v1/households?action=members&household_id=123',\n    method: 'GET',\n    success: function(response) {\n        if(response.status === 'success') {\n            console.log('Members:', response.data);\n        }\n    }\n});"
            }
          ]
        }
      ]
    },
    {
      "id": "certificate-mgmt",
      "title": "üìã Certificate Management",
      "content": [
        {
          "type": "paragraph",
          "text": "Generate, track, and manage barangay certificates including clearance, residency, and indigency certificates."
        },
        {
          "type": "card",
          "title": "Supported Certificates",
          "content": "‚Ä¢ **Barangay Clearance** - General good moral character certification\n‚Ä¢ **Residency Certificate** - Proof of residence in the barangay\n‚Ä¢ **Indigency Certificate** - Certification of financial need\n‚Ä¢ **Custom Certificates** - Extensible system for additional types"
        }
      ],
      "subsections": [
        {
          "title": "Database Schema",
          "content": [
            {
              "type": "code",
              "code": "CREATE TABLE certificate_request (\n    id INT(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n    resident_id INT(11) UNSIGNED NOT NULL,\n    certificate_type VARCHAR(100) NOT NULL,\n    purpose TEXT,\n    status ENUM('Pending', 'Approved', 'Rejected') DEFAULT 'Pending',\n    issued_by INT(11) UNSIGNED,\n    requested_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    approved_at TIMESTAMP NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n    FOREIGN KEY (resident_id) REFERENCES residents(id),\n    FOREIGN KEY (issued_by) REFERENCES users(id)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;"
            }
          ]
        },
        {
          "title": "API Endpoints (v1.4.0+)",
          "content": [
            {
              "type": "table",
              "headers": ["Endpoint", "Method", "Description"],
              "rows": [
                ["/api/v1/certificates", "GET", "List all certificate requests"],
                ["/api/v1/certificates?id=X", "GET", "Get certificate by ID"],
                ["/api/v1/certificates?resident_id=X", "GET", "Get certificates by resident"],
                ["/api/v1/certificates?action=stats", "GET", "Get certificate statistics"],
                ["/api/v1/certificates", "POST", "Create certificate request (action: 'create')"],
                ["/api/v1/certificates", "POST", "Update certificate status (action: 'update_status')"]
              ]
            }
          ]
        },
        {
          "title": "Usage Example (v1.4.0+)",
          "content": [
            {
              "type": "code",
              "code": "// Submit certificate request via API\n$.ajax({\n    url: '/api/v1/certificates',\n    method: 'POST',\n    contentType: 'application/json',\n    data: JSON.stringify({\n        action: 'create',\n        resident_id: 123,\n        certificate_type: 'Barangay Clearance',\n        purpose: 'Employment requirement',\n        status: 'Pending'\n    }),\n    success: function(response) {\n        if(response.status === 'success') {\n            console.log('Certificate requested:', response.data);\n        }\n    }\n});\n\n// Update certificate status via API\n$.ajax({\n    url: '/api/v1/certificates',\n    method: 'POST',\n    contentType: 'application/json',\n    data: JSON.stringify({\n        action: 'update_status',\n        id: 456,\n        status: 'Approved',\n        issued_by: 10\n    }),\n    success: function(response) {\n        if(response.status === 'success') {\n            console.log('Certificate updated:', response.data);\n        }\n    }\n});"
            }
          ]
        },
        {
          "title": "Print Certificate",
          "content": [
            {
              "type": "paragraph",
              "text": "Certificates can be printed with customizable scaling and margins:"
            },
            {
              "type": "code",
              "code": "// Access print page\nwindow.location.href = '/certificate/print?id=456';\n\n// JavaScript scale control\nfunction applyScale(scale) {\n    const cert = document.getElementById('certificateContent');\n    cert.style.transform = `scale(${scale})`;\n    cert.style.transformOrigin = 'top center';\n}"
            }
          ]
        }
      ]
    },
    {
      "id": "officers",
      "title": "üëî Officers Management",
      "content": [
        {
          "type": "paragraph",
          "text": "Manage barangay officers including Barangay Captain, Secretary, Treasurer, and other positions with term tracking."
        },
        {
          "type": "card",
          "title": "Key Features",
          "content": "‚Ä¢ Add officers with position and term dates\n‚Ä¢ Link officers to resident records\n‚Ä¢ Track officer status (Active/Inactive)\n‚Ä¢ Term period management\n‚Ä¢ Only one active Barangay Captain allowed\n‚Ä¢ Position-based access control"
        }
      ],
      "subsections": [
        {
          "title": "Database Schema",
          "content": [
            {
              "type": "code",
              "code": "CREATE TABLE officers (\n    id INT(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n    user_id INT(11) NULL,\n    resident_id INT(11) UNSIGNED NULL,\n    position VARCHAR(150) NOT NULL,\n    term_start DATE NOT NULL,\n    term_end DATE NOT NULL,\n    status ENUM('Active', 'Inactive') DEFAULT 'Active',\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL,\n    FOREIGN KEY (resident_id) REFERENCES residents(id) ON DELETE SET NULL\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;"
            }
          ]
        },
        {
          "title": "Usage Example",
          "content": [
            {
              "type": "code",
              "code": "// Create officer record\n// Only one active Barangay Captain is allowed\nconst officerData = {\n    user_id: 5,\n    resident_id: 10,\n    position: 'Barangay Captain',\n    term_start: '2024-01-01',\n    term_end: '2028-12-31',\n    status: 'Active'\n};\n\n// When creating an Active Barangay Captain,\n// other active captains are automatically deactivated\n$.post('/admin/add_account', officerData, function(response) {\n    console.log('Officer created:', response);\n});"
            }
          ]
        }
      ]
    },
    {
      "id": "blotter",
      "title": "üìù Blotter System",
      "content": [
        {
          "type": "paragraph",
          "text": "Incident reporting and case management system for barangay tanod (security personnel)."
        },
        {
          "type": "card",
          "title": "Key Features",
          "content": "‚Ä¢ Create incident reports (blotter entries)\n‚Ä¢ Track case status (pending, resolved, etc.)\n‚Ä¢ Search incidents by date, type, or resident\n‚Ä¢ View detailed incident history\n‚Ä¢ Tanod-specific access control"
        }
      ],
      "subsections": [
        {
          "title": "Database Schema",
          "content": [
            {
              "type": "code",
              "code": "CREATE TABLE blotter (\n    id INT(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n    incident_type VARCHAR(100) NOT NULL,\n    complainant VARCHAR(255),\n    respondent VARCHAR(255),\n    date_of_incident DATE NOT NULL,\n    location VARCHAR(255),\n    description TEXT,\n    status VARCHAR(50) DEFAULT 'Pending',\n    remarks TEXT,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;"
            }
          ]
        },
        {
          "title": "API Endpoints (v1.4.0+)",
          "content": [
            {
              "type": "table",
              "headers": ["Endpoint", "Method", "Description"],
              "rows": [
                ["/api/v1/blotter", "GET", "List all blotter cases"],
                ["/api/v1/blotter?id=X", "GET", "Get blotter case by ID"],
                ["/api/v1/blotter?action=stats", "GET", "Get blotter statistics"],
                ["/api/v1/blotter", "POST", "Create blotter case (action: 'create')"],
                ["/api/v1/blotter", "POST", "Update case status (action: 'update_status')"]
              ]
            }
          ]
        },
        {
          "title": "Usage Example (v1.4.0+)",
          "content": [
            {
              "type": "code",
              "code": "// Create blotter case via API\n$.ajax({\n    url: '/api/v1/blotter',\n    method: 'POST',\n    contentType: 'application/json',\n    data: JSON.stringify({\n        action: 'create',\n        complainant_name: 'Juan Dela Cruz',\n        respondent_name: 'Maria Santos',\n        incident_date: '2025-01-15',\n        incident_location: 'Barangay Hall',\n        incident_description: 'Dispute over property boundary'\n    }),\n    success: function(response) {\n        if(response.status === 'success') {\n            console.log('Case created:', response.data.case_number);\n        }\n    }\n});\n\n// Update case status\n$.ajax({\n    url: '/api/v1/blotter',\n    method: 'POST',\n    contentType: 'application/json',\n    data: JSON.stringify({\n        action: 'update_status',\n        id: 123,\n        status: 'resolved',\n        resolution: 'Settled amicably',\n        resolved_date: '2025-01-16'\n    }),\n    success: function(response) {\n        if(response.status === 'success') {\n            console.log('Status updated');\n        }\n    }\n});"
            }
          ]
        }
      ]
    },
    {
      "id": "auth",
      "title": "üîê Authentication & Authorization",
      "content": [
        {
          "type": "paragraph",
          "text": "Role-based access control system with multiple user types and permission levels."
        },
        {
          "type": "card",
          "title": "User Roles",
          "content": "‚Ä¢ **Admin** - Full system access, user management\n‚Ä¢ **Staff** - Resident, certificate, and officer management\n‚Ä¢ **Tanod** - Blotter system access\n‚Ä¢ **Custom Positions** - Staff members with specific roles (Secretary, Treasurer, etc.)"
        }
      ],
      "subsections": [
        {
          "title": "Database Schema",
          "content": [
            {
              "type": "code",
              "code": "CREATE TABLE users (\n    id INT(11) UNSIGNED AUTO_INCREMENT PRIMARY KEY,\n    name VARCHAR(255) NOT NULL,\n    username VARCHAR(100) NOT NULL UNIQUE,\n    password VARCHAR(255) NOT NULL,\n    email VARCHAR(100),\n    role ENUM('Admin', 'Staff', 'Tanod') DEFAULT 'Staff',\n    position VARCHAR(150),\n    profile_picture VARCHAR(255),\n    status ENUM('Active', 'Inactive') DEFAULT 'Active',\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;"
            }
          ]
        },
        {
          "title": "API Endpoints (v1.4.0+)",
          "content": [
            {
              "type": "table",
              "headers": ["Endpoint", "Method", "Description"],
              "rows": [
                ["/api/v1/auth", "POST", "User login (returns session data)"],
                ["/api/v1/admin", "GET", "List all users/officers"],
                ["/api/v1/admin?id=X", "GET", "Get user/officer by ID"],
                ["/api/v1/admin", "POST", "Create user/officer (action: 'create')"],
                ["/api/v1/admin", "POST", "Update user/officer (action: 'update')"],
                ["/api/v1/admin", "POST", "Delete user/officer (action: 'delete')"]
              ]
            }
          ]
        },
        {
          "title": "Usage Example (v1.4.0+)",
          "content": [
            {
              "type": "code",
              "code": "// Login via API\n$.ajax({\n    url: '/api/v1/auth',\n    method: 'POST',\n    contentType: 'application/json',\n    data: JSON.stringify({\n        username: 'admin',\n        password: 'password123'\n    }),\n    success: function(response) {\n        if(response.status === 'success') {\n            console.log('Logged in as:', response.data.name);\n            // Session is set server-side\n        }\n    }\n});\n\n// Create user account via API\n$.ajax({\n    url: '/api/v1/admin',\n    method: 'POST',\n    contentType: 'application/json',\n    data: JSON.stringify({\n        action: 'create',\n        name: 'John Doe',\n        username: 'johndoe',\n        password: 'securepass',\n        role: 'staff'\n    }),\n    success: function(response) {\n        if(response.status === 'success') {\n            console.log('User created:', response.data);\n        }\n    }\n});"
            }
          ]
        }
      ]
    },
    {
      "id": "dashboard",
      "title": "üìä Dashboard Analytics",
      "content": [
        {
          "type": "paragraph",
          "text": "Role-based dashboard showing relevant statistics and metrics."
        },
        {
          "type": "card",
          "title": "Dashboard Metrics",
          "content": "‚Ä¢ **Total Residents** - Active and inactive count\n‚Ä¢ **Households** - Number of registered households\n‚Ä¢ **Certificates Issued** - Certificate statistics by type\n‚Ä¢ **Blotter Cases** - Incident reports and status breakdown\n‚Ä¢ **Active Officers** - Current officer positions\n‚Ä¢ **User Statistics** - System user count by role"
        }
      ],
      "subsections": [
        {
          "title": "Dashboard API",
          "content": [
            {
              "type": "code",
              "code": "// Fetch dashboard data\n$.get('/api/dashboard_data', function(data) {\n    console.log('Total Residents:', data.residents.total);\n    console.log('Households:', data.households.total);\n    console.log('Certificates:', data.certificates);\n    console.log('Blotter Cases:', data.blotter);\n    \n    // Update UI\n    $('#residentCount').text(data.residents.total);\n    $('#householdCount').text(data.households.total);\n});"
            }
          ]
        }
      ]
    },
    {
      "id": "utilities",
      "title": "üõ†Ô∏è Utility Functions",
      "content": [
        {
          "type": "paragraph",
          "text": "Common utility functions available throughout the system for developers."
        }
      ],
      "subsections": [
        {
          "title": "Dialog Functions",
          "content": [
            {
              "type": "code",
              "code": "// Show confirmation dialog\nfunction showConfirmDialog(title, message, callback) {\n    $('<div>' + message + '</div>').dialog({\n        modal: true,\n        title: title,\n        width: 420,\n        buttons: {\n            'Yes': function() {\n                $(this).dialog('close');\n                callback(true);\n            },\n            'No': function() {\n                $(this).dialog('close');\n                callback(false);\n            }\n        }\n    });\n}\n\n// Show info dialog\nfunction showDialog(title, message) {\n    $('<div>' + message + '</div>').dialog({\n        modal: true,\n        title: title,\n        width: 420,\n        buttons: {\n            'Ok': function() {\n                $(this).dialog('close');\n            }\n        }\n    });\n}"
            }
          ]
        },
        {
          "title": "Form Validation",
          "content": [
            {
              "type": "code",
              "code": "// Validate form fields\nfunction validateForm() {\n    let errors = [];\n    \n    const firstName = $('#first_name').val().trim();\n    if(!firstName) {\n        errors.push('First name is required');\n    }\n    \n    const email = $('#email').val().trim();\n    if(email && !isValidEmail(email)) {\n        errors.push('Invalid email format');\n    }\n    \n    if(errors.length > 0) {\n        alert(errors.join('\\n'));\n        return false;\n    }\n    return true;\n}\n\n// Validate email\nfunction isValidEmail(email) {\n    const regex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return regex.test(email);\n}"
            }
          ]
        }
      ]
    },
    {
      "id": "migration",
      "title": "üîÑ Database Migrations",
      "content": [
        {
          "type": "paragraph",
          "text": "System uses a migration framework for database schema evolution. Migrations can be run via browser interface or CLI."
        },
        {
          "type": "card",
          "title": "Available Migrations",
          "content": "‚Ä¢ `create_users_table.php` - User authentication\n‚Ä¢ `create_residents_table.php` - Resident data\n‚Ä¢ `create_households_table.php` - Household grouping\n‚Ä¢ `create_officers_table.php` - Officer management\n‚Ä¢ `create_blotter_table.php` - Incident reports\n‚Ä¢ `create_certificates_request_table.php` - Certificate tracking\n‚Ä¢ `merge_staff_officers.php` - Integration of staff and officers\n‚Ä¢ `add_indexes.php` - Performance optimization"
        }
      ],
      "subsections": [
        {
          "title": "Running Migrations",
          "content": [
            {
              "type": "code",
              "code": "// Via browser - visit /schema/run.php\n// The system will automatically run all pending migrations\n\n// Or manually run a single migration\ninclude 'schema/create_residents_table.php';\n\n// CLI approach (if available)\n// php schema/run.php"
            }
          ]
        }
      ]
    }
  ]
}
